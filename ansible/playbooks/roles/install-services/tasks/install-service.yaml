---
- name: "Ensure {{ service.name }} folders exists"
  become: false
  file:
    path: "{{ item }}"
    state: directory
  with_items: "{{ service.folders }}"

- name: Generate {{ service.name }}} service config
  become: false
  template:
    src: "{{ service.service_config }}"
    dest: "{{ svc_services_dir }}/{{ service.name }}.yaml"

- name: Generate {{ service.name }} files from templates
  become: false
  template:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
  with_items: "{{ service.templates }}"